<!--pages/myMap/myMap.wxml-->
<view class="container">
  <view class="switch-date">
    <van-cell class="date" value="{{ date }}" bind:click="onCalendarDisplay" />
    <van-calendar show="{{showCalendar}}" show-confirm="{{ false }}" bind:close="onCalendarClose"
      bind:confirm="onCalendarConfirm" show-mark="{{true}}" position="top" />
  </view>
  <view class="icon-on-left">
    <van-icon bind:click="load_yesterday" name="arrow-left" size="2em" />
  </view>
  <view class="icon-on-right">
    <van-icon bind:click="load_tomorrow" name="arrow" size="2em" />
  </view>
  <!-- if tmp date has schedule -->
  <block wx:if="{{hasSchedule}}">
    <!--地图容器-->
    <!-- 若将markers polyline等属性放在setting字典中: 实机测试时更新后不能自动渲染至map -->
    <map id="map" bindcallouttap="route_planning" setting="{{mapSetting}}" markers="{{markers}}"
      polyline="{{polyline}}">
      <cover-view slot="callout">
        <cover-view wx:for="{{markers}}" marker-id="{{item.id}}" class="customCallout">{{item.id}}</cover-view>
      </cover-view>
      <cover-view></cover-view>

    </map>
    <view class="pullUpButton" bindtap="show_subpage">^^^</view>
    <view class="scheduleInfo">{{dest}} {{title}} 第{{tmpDay+1}}天 </view>
    <!-- <view><button bindtap="route_planning">test</button></view> -->
  </block>

  <block wx:else>
    <view class="button-add">
      <button bindtap="add_schedule">+添加日程+</button>
    </view>
  </block>

</view>
<page-container class="container" show="{{showSubPage}}" overlay="true" position="bottom"
  close-on-slide-down="{{false}}" custom-style="height:94%" overlay-style="background-color: rgba(255, 255, 255, 0.7)"
  bind:enter="load_destinations" bind:leave="render_map">

  <view class="pullDownButton" bindtap="exit_subpage">^^^</view>

  <!-- <view class="searchBlock">
    <view class="searchIcon">Icon</view>
    <input class="inputForm" bindinput="getsuggest" value="{{backfill}}" placeholder="请输入想去的地点"></input>
    <view bindtap="add_location">添加</view>
  </view> -->
  <van-search value="{{chosenLocation}}" placeholder="请输入搜索关键词" bind:change="get_suggestion"
    bind:clear="clear_search" />

  <scroll-view scroll-y="true" style="height:{{showSelect?500:0}}rpx;">
    <!--绑定回填事件-->
    <view class="search-results" wx:for="{{suggestion}}" wx:key="index">
      <!--根据需求渲染相应数据-->
      <!--渲染地址title-->
      <view class="font-results" bind:tap="add_location" id="{{index}}">
        <view>{{item.title}}</view>
        <view style="font-size:12px;color:#666;">{{item.addr}}</view>
      </view>
      <!--渲染详细地址-->
      <view bindtap="show_onMap">Icon</view>
    </view>
  </scroll-view>

  <block wx:for="{{markers}}">
    <view>
      {{index+1}}:{{item.callout.content}}
    </view>
  </block>
  <view>
  </view>
</page-container>