<!--pages/addSchedule/addSchedule.wxml-->

<!--pages/myMap/myMap.wxml-->

<page-meta scroll-top="{{pageMetaScrollTop}}"></page-meta>
<block wx:if="{{showSetting}}">
  <view class="container">
    <view>行程命名</view>
    <van-cell title="行程名称"></van-cell>
    <van-cell class="date" value="{{ date }}" title="选择日期" bind:click="onCalendarDisplay" />
    <van-calendar show="{{showCalendar}}" bind:close="onCalendarClose" bind:confirm="onCalendarConfirm"
      show-confirm="{{false}}" type="range" allow-same-day="{{true}}" max-range="{{ 14 }}" position="bottom"
      min-date="{{ minDate }}" max-date="{{ maxDate }}" />
    <van-cell title="天数"></van-cell>
    <van-button round type="primary" bind:tap="confirm_setting">确认</van-button>
    <van-button round type="primary">保存</van-button>
  </view>

</block>

<block wx:else>
  <view class="container">
    <van-search value="{{chosenLocation}}" placeholder="请输入搜索关键词" bind:change="get_suggestion"
      bind:clear="clear_search" />
    <scroll-view scroll-y="true" style="height:{{showSelect?700:0}}rpx;">
      <!--绑定回填事件-->
      <view class="search-results" wx:for="{{suggestion}}" wx:key="index">
        <!--根据需求渲染相应数据-->
        <!--渲染地址title-->
        <view class="font-results" bind:tap="add_location" id="{{index}}">
          <view>{{item.title}}</view>
          <view style="font-size:12px;color:#666;">{{item.addr}}</view>
        </view>
        <!--渲染详细地址-->
        <view bindtap="show_onMap">Icon</view>
      </view>
    </scroll-view>

    <view style="margin: 4rpx;">
      <wxp-drag id="drag" generic:item="wxp-drag-item" bind:click="itemClick" bind:change="change"
        bind:sortend="sortEnd" bind:scroll="scroll" item-wrap-class="drag-item-wrap" extra-nodes="{{extraNodes}}"
        list-data="{{listData}}" columns="{{size}}" scroll-top="{{scrollTop}}" item-height="{{(750 - 8) / size}}"
        top-size="80" bottom-size="0">
      </wxp-drag>
    </view>

    <image src="../../resources/icons8-double-up.gif" class="icon-double-up" bindtap="show_subpage"></image>


  </view>

  <page-container class="container" show="{{showSubPage}}" overlay="true" position="bottom"
    close-on-slide-down="{{false}}" custom-style="z-index:1;height:100%"
    overlay-style="background-color: rgba(255, 255, 255, 0.7)" bind:enter="load_destinations" bind:leave="render_map">

    <image src="../../resources/icons8-double-down.gif" class="icon-double-down" bindtap="exit_subpage"></image>

    <view wx:if="{{tmpDay==0?false:true}}"class="icon-on-left">
      <van-icon bind:click="load_yesterday" name="arrow-left" size="2em" />
    </view>
    <view wx:if="{{tmpDay==days-1?false:true}}"class="icon-on-right">
      <van-icon bind:click="load_tomorrow" name="arrow" size="2em" />
    </view>

    <map id="map" bindcallouttap="route_planning" setting="{{mapSetting}}" markers="{{markers}}"
      polyline="{{polyline}}">
      <cover-view slot="callout">
        <!-- 绑定marker-id -->
        <cover-view wx:for="{{markers}}" marker-id="{{item.id}}" class="customCallout">{{item.id}}</cover-view>
      </cover-view>
      <cover-view></cover-view>
    </map>
    <view class="bottom-tagbar">
      <van-tabs active="{{activeTag}}" bind:click="onTagClick" z-index="100" animated="true" color="blue">
        <block wx:for="{{dayData}}">
          <van-tab title="第{{index+1}}天"></van-tab>
        </block>
      </van-tabs>
    </view>
    <view><button bindtap="route_planning">test</button></view>
  </page-container>
</block>